<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plataforma de Estudio: MCM y MCD</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script" async></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Open Sans', sans-serif;
            background-color: #46178F;
            color: white;
        }
        h1, h2, h3, .font-title {
            font-family: 'Montserrat', sans-serif;
        }
        .kahoot-bg { background-color: #46178F; }
        .btn-red { background-color: #E21B3C; }
        .btn-blue { background-color: #1368CE; }
        .btn-green { background-color: #26890C; }
        .btn-yellow { background-color: #D89E00; }
        .btn-shape {
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.25rem;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
            transition: transform 0.1s ease-in-out;
            width: 100%;
        }
        .btn-shape:hover { transform: scale(1.05); }
        .correct-answer {
            animation: pulse-green 1s ease-in-out;
            box-shadow: 0 0 20px 5px rgba(46, 204, 113, 0.8);
        }
        .wrong-answer { opacity: 0.5; }
        .disabled-button { pointer-events: none; }
        @keyframes pulse-green { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
        .timer-bar { transition: width 1s linear; }
        .study-container { max-height: 85vh; overflow-y: auto; }
        
        /* Achievement Notification */
        #achievement-notification {
            transition: transform 0.5s ease-in-out, opacity 0.5s ease-in-out;
            transform: translateY(150%);
            opacity: 0;
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000;
        }
        #achievement-notification.show {
            transform: translateY(0) translateX(-50%);
            opacity: 1;
        }

        /* XP Bar */
        .xp-bar-container { background-color: #2c0e5a; border-radius: 9999px; overflow: hidden; }
        .xp-bar { background-color: #39e6a3; transition: width 0.5s ease-in-out; }
    </style>
</head>
<body class="kahoot-bg min-h-screen flex items-center justify-center p-4">

    <div id="container" class="w-full max-w-5xl mx-auto text-center">

        <!-- Pantalla de Inicio -->
        <div id="start-screen">
            <h1 class="text-6xl md:text-8xl font-black tracking-tighter mb-4 font-title">Aritm√©tica - CUPREX</h1>
            <h2 class="text-4xl md:text-6xl font-bold mb-8 font-title">Tema: MCM y MCD</h2>
            
            <!-- Gamification Profile -->
            <div id="gamification-profile" class="bg-white/10 p-4 rounded-lg mb-6 max-w-md mx-auto">
                <div class="flex items-center justify-between mb-2">
                    <div id="profile-level" class="font-bold text-xl bg-yellow-500 text-black rounded-full w-12 h-12 flex items-center justify-center font-title">1</div>
                    <div class="text-left flex-grow ml-4">
                        <div id="profile-name" class="font-bold text-lg">Estudiante</div>
                        <div id="profile-achievements" class="text-sm">Logros: 0/5</div>
                    </div>
                </div>
                <div class="xp-bar-container w-full h-4">
                    <div id="profile-xp-bar" class="xp-bar h-4" style="width: 0%;"></div>
                </div>
                <div id="profile-xp-text" class="text-sm mt-1 text-right">0/100 XP</div>
            </div>

            <div class="bg-white/20 p-6 rounded-lg mb-8 max-w-2xl mx-auto">
                <h3 class="text-2xl font-bold mb-4 font-title">Configuraci√≥n</h3>
                <div class="flex flex-col sm:flex-row justify-center items-center gap-6">
                    <div>
                        <label for="question-count" class="font-bold block mb-1">N¬∫ de Preguntas:</label>
                        <input type="number" id="question-count" value="10" min="1" max="25" class="w-24 text-center text-black font-bold p-2 rounded">
                    </div>
                    <div>
                        <label for="time-limit" class="font-bold block mb-1">Segundos/Pregunta:</label>
                        <input type="number" id="time-limit" value="90" min="10" step="5" class="w-24 text-center text-black font-bold p-2 rounded">
                    </div>
                    <div>
                        <label for="question-order" class="font-bold block mb-1">Orden:</label>
                        <select id="question-order" class="w-32 text-center text-black font-bold p-2 rounded">
                            <option value="random">Aleatorio</option>
                            <option value="sequential">En Orden</option>
                        </select>
                    </div>
                </div>
            </div>

            <button id="start-button" class="bg-white text-gray-800 text-3xl font-bold py-4 px-12 rounded-lg shadow-2xl hover:bg-gray-200 transition-transform transform hover:scale-105 mb-8 font-title">
                ¬°Empezar!
            </button>

            <div class="flex flex-wrap justify-center gap-4 mt-4">
                <button id="study-guide-btn" class="bg-purple-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-purple-700">Gu√≠a de Estudio</button>
                <button id="view-problems-btn" class="bg-blue-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-700">Ver Problemas</button>
                <button id="view-solutions-btn" class="bg-green-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-green-700">Ver Soluciones</button>
                <button id="view-references-btn" class="bg-yellow-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-yellow-700">Referencias</button>
            </div>
        </div>

        <!-- Contenedor para material de estudio -->
        <div id="study-material-container" class="hidden bg-white text-gray-800 rounded-lg p-8 text-left study-container">
            <div id="study-content"></div>
            <button id="close-study-btn" class="mt-6 bg-red-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-red-700 w-full font-title">Cerrar</button>
        </div>


        <!-- Pantalla del Quiz -->
        <div id="quiz-screen" class="hidden">
            <div class="flex justify-between items-center bg-white text-gray-800 p-4 rounded-t-lg font-title">
                <div id="question-counter" class="text-xl font-bold">1 de 10</div>
                <div class="text-2xl font-black">Desaf√≠o MCM y MCD</div>
                <div id="score" class="text-xl font-bold">Puntos: 0</div>
            </div>
            <div class="bg-gray-800 p-8">
                <div id="timer-container" class="w-full bg-gray-600 rounded-full h-4 mb-6">
                    <div id="timer-bar" class="bg-yellow-400 h-4 rounded-full" style="width: 100%;"></div>
                </div>
                <h2 id="question-text" class="text-2xl md:text-3xl font-bold mb-4 min-h-[100px] font-title">Cargando pregunta...</h2>
                <div id="tip-text" class="text-yellow-300 italic h-6"></div>
            </div>
            <div class="flex flex-col gap-4 p-4 bg-gray-800 rounded-b-lg">
                <button data-option="0" class="answer-btn btn-shape btn-red rounded-lg h-24 font-title"></button>
                <button data-option="1" class="answer-btn btn-shape btn-blue rounded-lg h-24 font-title"></button>
                <button data-option="2" class="answer-btn btn-shape btn-green rounded-lg h-24 font-title"></button>
                <button id="next-button" class="btn-shape bg-gray-700 rounded-lg h-24 hidden mt-4 font-title">Siguiente</button>
            </div>
            <div id="feedback-text" class="mt-4 text-xl font-bold h-8"></div>
        </div>

        <!-- Pantalla de Resultados -->
        <div id="results-screen" class="hidden">
            <h1 class="text-5xl font-black mb-4 font-title">¬°Juego Terminado!</h1>
            <div class="bg-white text-gray-800 rounded-lg p-8 text-center shadow-2xl">
                <h2 class="text-3xl font-bold mb-2 font-title">Tu Puntuaci√≥n Final</h2>
                <p id="final-score" class="text-8xl font-black text-blue-600 mb-2 font-title">0</p>
                <p id="xp-gain-text" class="text-2xl font-bold text-green-500 mb-6"></p>
                <p id="final-summary" class="text-2xl mb-8">Obtuviste 0 de 10 correctas.</p>
                <button id="restart-button" class="bg-green-500 text-white text-2xl font-bold py-3 px-10 rounded-lg hover:bg-green-600 transition-transform transform hover:scale-105 font-title">
                    Jugar de Nuevo
                </button>
            </div>
        </div>
    </div>
    
    <!-- Notificaci√≥n de Logro -->
    <div id="achievement-notification" class="bg-yellow-400 text-black p-4 rounded-lg shadow-lg flex items-center gap-4">
        <div class="text-3xl">üèÜ</div>
        <div>
            <div id="achievement-title" class="font-bold">¬°Logro Desbloqueado!</div>
            <div id="achievement-desc"></div>
        </div>
    </div>

    <script>
        const allQuestions = [
            // (25 questions from previous context, redacted for brevity)
            { question: "Tres luces intermitentes se encienden a intervalos de 4, 6 y 10 segundos. Si coinciden a las 7:00 p.m., ¬ødespu√©s de cu√°ntos segundos volver√°n a coincidir?", answers: [ { text: "60 segundos", correct: true, explanation: "¬°Correcto! Se busca un 'punto de encuentro' futuro, lo que requiere el M√≠nimo Com√∫n M√∫ltiplo (mcm). El mcm de 4, 6 y 10 es 60." }, { text: "2 segundos", correct: false, explanation: "Incorrecto. Este valor es el M√°ximo Com√∫n Divisor (mcd) de 4 y 6. El mcd se usa para 'dividir' o 'repartir' en partes iguales, no para encontrar futuras coincidencias." }, { text: "120 segundos", correct: false, explanation: "Incorrecto. Aunque 120 es un m√∫ltiplo com√∫n de los tres n√∫meros, no es el *m√≠nimo*. El mcm es el primer punto en el que coinciden, que es 60." } ] },
            { question: "Un carpintero quiere cortar dos listones de madera de 90 cm y 120 cm en trozos de igual longitud, lo m√°s largos posible. ¬øCu√°l debe ser la longitud de cada trozo?", answers: [ { text: "10 cm", correct: false, explanation: "Incorrecto. Aunque 10 cm es un divisor com√∫n de 90 y 120, no es el *m√°ximo* posible. Se pueden hacer trozos m√°s grandes." }, { text: "360 cm", correct: false, explanation: "Incorrecto. Este valor es el mcm. No puedes cortar un list√≥n de 90 cm en trozos de 360 cm. El mcm se usa para encontrar m√∫ltiplos, no divisores." }, { text: "30 cm", correct: true, explanation: "¬°Correcto! Se busca 'dividir' en partes iguales y lo 'm√°s largas posible', lo que indica que se necesita el M√°ximo Com√∫n Divisor (mcd). El mcd de 90 y 120 es 30." } ] },
            { question: "Calcule el M√°ximo Com√∫n Divisor (mcd) de 24, 36 y 48.", answers: [ { text: "12", correct: true, explanation: "¬°Correcto! El 12 es el n√∫mero m√°s grande que puede dividir exactamente a 24 (12x2), 36 (12x3) y 48 (12x4)." }, { text: "144", correct: false, explanation: "Incorrecto. Este valor es el mcm de los tres n√∫meros. El mcd debe ser menor o igual al n√∫mero m√°s peque√±o del grupo (24)." }, { text: "6", correct: false, explanation: "Incorrecto. Aunque 6 es un divisor com√∫n, no es el *m√°ximo*. El 12 tambi√©n es un divisor com√∫n y es m√°s grande." } ] },
            { question: "Un paciente toma un jarabe cada 6 horas y una pastilla cada 8 horas. Si tom√≥ ambos a las 9:00 a.m., ¬øa qu√© hora volver√° a tomar ambos medicamentos juntos?", answers: [ { text: "A las 9:00 a.m. del siguiente d√≠a", correct: true, explanation: "¬°Correcto! Buscamos la pr√≥xima coincidencia en el tiempo, por lo que usamos el mcm. El mcm de 6 y 8 es 24. Por lo tanto, coincidir√°n 24 horas despu√©s, que es a las 9:00 a.m. del d√≠a siguiente." }, { text: "A la 1:00 p.m. del mismo d√≠a", correct: false, explanation: "Incorrecto. Esto ser√≠a solo 4 horas despu√©s. 4 no es m√∫ltiplo ni de 6 ni de 8." }, { text: "A las 9:00 p.m. del mismo d√≠a", correct: false, explanation: "Incorrecto. Esto es 12 horas despu√©s. A las 12 horas, habr√≠a tomado el jarabe (6x2) pero no la pastilla (8x1.5)." } ] },
            { question: "Calcule el M√≠nimo Com√∫n M√∫ltiplo (mcm) de 15, 20 y 30.", answers: [ { text: "5", correct: false, explanation: "Incorrecto. Este es el mcd de los tres n√∫meros. El mcm debe ser mayor o igual al n√∫mero m√°s grande del grupo (30)." }, { text: "60", correct: true, explanation: "¬°Correcto! 60 es el n√∫mero m√°s peque√±o que puede ser dividido exactamente por 15 (15x4), 20 (20x3) y 30 (30x2)." }, { text: "120", correct: false, explanation: "Incorrecto. 120 es un m√∫ltiplo com√∫n, pero no es el *m√≠nimo*. El 60 tambi√©n es un m√∫ltiplo com√∫n y es m√°s peque√±o." } ] },
            { question: "Se tienen 54 chocolates y 72 caramelos. Se quieren armar bolsas con la misma cantidad de cada dulce, de modo que se use el mayor n√∫mero de bolsas posible. ¬øCu√°ntos chocolates habr√° en cada bolsa?", answers: [ { text: "18", correct: false, explanation: "Incorrecto. ¬°Cuidado! 18 es el mcd, que representa el n√∫mero total de bolsas que se pueden armar. La pregunta es cu√°ntos *chocolates* hay en cada bolsa." }, { text: "4", correct: false, explanation: "Incorrecto. Este es el n√∫mero de *caramelos* por bolsa (72 caramelos / 18 bolsas = 4)." }, { text: "3", correct: true, explanation: "¬°Correcto! Es un problema de dos pasos. Primero, el mcd(54, 72) = 18 nos da el n√∫mero de bolsas. Luego, 54 chocolates / 18 bolsas = 3 chocolates por bolsa." } ] },
            { question: "Si el mcd de dos n√∫meros es 6 y su mcm es 72, y uno de los n√∫meros es 18, ¬øcu√°l es el otro n√∫mero?", answers: [ { text: "24", correct: true, explanation: "¬°Correcto! Se usa la propiedad: a √ó b = mcd(a,b) √ó mcm(a,b). Entonces, 18 √ó b = 6 √ó 72, que es 432. Despejando b: 432 / 18 = 24." }, { text: "12", correct: false, explanation: "Incorrecto. Si los n√∫meros fueran 18 y 12, su mcd ser√≠a 6, pero su mcm ser√≠a 36, no 72." }, { text: "36", correct: false, explanation: "Incorrecto. Si los n√∫meros fueran 18 y 36, su mcd ser√≠a 18, no 6." } ] },
            { question: "Ana va a la biblioteca cada 4 d√≠as y Luis va cada 5 d√≠as. Si hoy se encontraron, ¬øen cu√°ntos d√≠as volver√°n a encontrarse?", answers: [ { text: "10 d√≠as", correct: false, explanation: "Incorrecto. En 10 d√≠as, Luis habr√° ido dos veces (5x2), pero Ana no (4x2.5)." }, { text: "20 d√≠as", correct: true, explanation: "¬°Correcto! Se busca el pr√≥ximo punto de encuentro, por lo que es el mcm. Como 4 y 5 son primos entre s√≠, su mcm es su producto: 4 √ó 5 = 20." }, { text: "9 d√≠as", correct: false, explanation: "Incorrecto. Este valor es la suma de los d√≠as (4+5). La suma no tiene relevancia para encontrar una coincidencia de m√∫ltiplos." } ] },
            { question: "Calcule el mcd de 100 y 150.", answers: [ { text: "25", correct: false, explanation: "Incorrecto. 25 es un divisor com√∫n, pero no es el *m√°ximo*. Hay un divisor m√°s grande que ambos comparten." }, { text: "50", correct: true, explanation: "¬°Correcto! 50 es el n√∫mero m√°s grande que divide a 100 (50x2) y 150 (50x3) de forma exacta." }, { text: "300", correct: false, explanation: "Incorrecto. Este es el mcm de 100 y 150. Recuerda que el mcd no puede ser m√°s grande que los n√∫meros originales." } ] },
            { question: "¬øCu√°l es el mcm de dos n√∫meros primos diferentes, como 7 y 13?", answers: [ { text: "1", correct: false, explanation: "Incorrecto. El 1 es el mcd de cualquier par de n√∫meros primos, no el mcm." }, { text: "Su suma (20)", correct: false, explanation: "Incorrecto. La suma no se utiliza para calcular el mcm." }, { text: "Su producto (91)", correct: true, explanation: "¬°Correcto! Como los n√∫meros primos no comparten factores (excepto el 1), su M√≠nimo Com√∫n M√∫ltiplo es siempre el resultado de multiplicarlos." } ] },
            { question: "Dos engranajes tienen 18 y 24 dientes. Si empiezan acoplados, ¬øcu√°ntas vueltas debe dar el engranaje m√°s peque√±o para que vuelvan a la posici√≥n inicial?", answers: [ { text: "3 vueltas", correct: false, explanation: "Incorrecto. Esto es el n√∫mero de vueltas que da el engranaje grande (72/24=3). La pregunta es sobre el engranaje peque√±o." }, { text: "4 vueltas", correct: true, explanation: "¬°Correcto! Se busca una coincidencia, un mcm. El mcm(18, 24) es 72. Para saber las vueltas del engranaje peque√±o, dividimos 72 / 18 = 4 vueltas." }, { text: "72 vueltas", correct: false, explanation: "Incorrecto. 72 es el n√∫mero total de dientes que deben pasar (el mcm), no el n√∫mero de vueltas del engranaje." } ] },
            { question: "Se quiere embaldosar una habitaci√≥n de 480 cm de largo por 360 cm de ancho con baldosas cuadradas, lo m√°s grandes posible. ¬øCu√°nto medir√° el lado de cada baldosa?", answers: [ { text: "1440 cm", correct: false, explanation: "Incorrecto. Este es el mcm. No puedes usar una baldosa m√°s grande que la propia habitaci√≥n. Se pide dividir el √°rea, no multiplicarla." }, { text: "60 cm", correct: false, explanation: "Incorrecto. 60 es un divisor com√∫n, pero no es el m√°s grande posible. El mcd es mayor." }, { text: "120 cm", correct: true, explanation: "¬°Correcto! Se pide 'dividir' el suelo en partes 'lo m√°s grandes posible', lo que indica el mcd. El mcd(480, 360) es 120 cm." } ] },
            { question: "Calcule el mcm de 9, 12 y 18.", answers: [ { text: "3", correct: false, explanation: "Incorrecto. Este es el mcd de los tres n√∫meros. El mcm siempre es mayor o igual al n√∫mero m√°s grande del grupo." }, { text: "36", correct: true, explanation: "¬°Correcto! 36 es el n√∫mero m√°s peque√±o que es divisible por 9 (9x4), 12 (12x3) y 18 (18x2)." }, { text: "72", correct: false, explanation: "Incorrecto. 72 es un m√∫ltiplo com√∫n, pero no es el *m√≠nimo*. 36 es m√°s peque√±o y tambi√©n es un m√∫ltiplo com√∫n." } ] },
            { question: "Calcule el mcd de 70, 105 y 140.", answers: [ { text: "35", correct: true, explanation: "¬°Correcto! 35 es el n√∫mero m√°s grande que divide a 70 (35x2), 105 (35x3) y 140 (35x4)." }, { text: "420", correct: false, explanation: "Incorrecto. Este es el mcm. El mcd debe ser un divisor, por lo tanto, menor o igual al n√∫mero m√°s peque√±o (70)." }, { text: "5", correct: false, explanation: "Incorrecto. 5 es un divisor com√∫n, pero no es el m√°ximo. 35 es m√°s grande." } ] },
            { question: "Dos corredores dan vueltas en una pista circular. Uno tarda 50 segundos por vuelta y el otro 60 segundos. Si parten juntos, ¬øcu√°ntos segundos pasar√°n hasta que se encuentren de nuevo en la l√≠nea de salida?", answers: [ { text: "10 segundos", correct: false, explanation: "Incorrecto. Este es el mcd de 50 y 60. El mcd no sirve para encontrar puntos de encuentro en el tiempo." }, { text: "300 segundos", correct: true, explanation: "¬°Correcto! Se busca una coincidencia en el futuro, por lo que calculamos el mcm. El mcm(50, 60) es 300 segundos." }, { text: "110 segundos", correct: false, explanation: "Incorrecto. Esto es la suma de los tiempos. La suma no indica una coincidencia de m√∫ltiplos." } ] },
            { question: "Se tienen tres cuerdas de 20, 30 y 42 metros. Se quieren cortar en trozos iguales y de la mayor longitud posible. ¬øCu√°ntos trozos se obtendr√°n en total?", answers: [ { text: "2 metros", correct: false, explanation: "Incorrecto. 2 metros es el mcd, que representa la longitud de cada trozo. La pregunta es por el n√∫mero total de trozos." }, { text: "46 trozos", correct: true, explanation: "¬°Correcto! Es un problema de dos pasos. El mcd(20, 30, 42) es 2 metros. Luego, se suman los trozos de cada cuerda: (20/2) + (30/2) + (42/2) = 10 + 15 + 21 = 46 trozos." }, { text: "92 trozos", correct: false, explanation: "Incorrecto. Esto es la suma de las longitudes. No representa el n√∫mero de trozos." } ] },
            { question: "El mcm de dos n√∫meros es 120 y su mcd es 4. Si uno de los n√∫meros es 24, ¬øcu√°l es el otro?", answers: [ { text: "480", correct: false, explanation: "Incorrecto. Este resultado proviene de multiplicar el mcm y el mcd, pero sin dividir por el n√∫mero conocido." }, { text: "20", correct: true, explanation: "¬°Correcto! Usando la propiedad a √ó b = mcm(a,b) √ó mcd(a,b), tenemos 24 √ó b = 120 √ó 4. Entonces, b = 480 / 24 = 20." }, { text: "30", correct: false, explanation: "Incorrecto. Si los n√∫meros fueran 24 y 30, su mcd ser√≠a 6 (no 4) y su mcm ser√≠a 120." } ] },
            { question: "Encuentre el n√∫mero m√°s peque√±o que al ser dividido por 3, 5 y 7 deja un residuo de 1.", answers: [ { text: "105", correct: false, explanation: "Incorrecto. 105 es el mcm de 3, 5 y 7. Se divide exactamente entre ellos, dejando residuo 0, no 1." }, { text: "106", correct: true, explanation: "¬°Correcto! Primero se calcula el mcm(3, 5, 7) = 105. Como siempre debe sobrar 1, se le suma al mcm: 105 + 1 = 106." }, { text: "22", correct: false, explanation: "Incorrecto. 22 dividido entre 3 deja residuo 1, pero dividido entre 5 deja residuo 2." } ] },
            { question: "El mcd de dos n√∫meros primos entre s√≠ es...", answers: [ { text: "0", correct: false, explanation: "Incorrecto. El mcd nunca es cero." }, { text: "El producto de los n√∫meros", correct: false, explanation: "Incorrecto. El producto de los n√∫meros es su mcm, no su mcd." }, { text: "1", correct: true, explanation: "¬°Correcto! Por definici√≥n, dos n√∫meros son primos entre s√≠ (o coprimos) si su √∫nico divisor com√∫n es 1. Por lo tanto, su mcd es 1." } ] },
            { question: "¬øCu√°l es el mcm de 16 y su doble, 32?", answers: [ { text: "16", correct: false, explanation: "Incorrecto. 16 es el mcd en este caso. El mcm no puede ser menor que el n√∫mero m√°s grande." }, { text: "32", correct: true, explanation: "¬°Correcto! Si un n√∫mero es m√∫ltiplo de otro, su mcm es el n√∫mero m√°s grande. 32 es m√∫ltiplo de 16, por lo que el mcm es 32." }, { text: "512", correct: false, explanation: "Incorrecto. Este es el producto de los dos n√∫meros. No es necesario multiplicar si uno es m√∫ltiplo del otro." } ] },
            { question: "Se quieren colocar 48 bol√≠grafos y 64 l√°pices en estuches, cada uno con el mismo n√∫mero de bol√≠grafos y l√°pices, y usando la mayor cantidad de estuches posible. ¬øCu√°ntos l√°pices habr√° en cada estuche?", answers: [ { text: "16", correct: false, explanation: "Incorrecto. 16 es el mcd, que representa el n√∫mero total de estuches a utilizar. La pregunta es por el n√∫mero de l√°pices." }, { text: "3", correct: false, explanation: "Incorrecto. Este es el n√∫mero de bol√≠grafos por estuche (48/16=3)." }, { text: "4", correct: true, explanation: "¬°Correcto! Primero, el mcd(48, 64) = 16 estuches. Luego, para saber los l√°pices por estuche, dividimos 64 / 16 = 4 l√°pices." } ] },
            { question: "Tres alarmas suenan cada 8, 10 y 15 minutos, respectivamente. Si suenan juntas al mediod√≠a, ¬øa qu√© hora volver√°n a sonar juntas?", answers: [ { text: "A las 12:40 p.m.", correct: false, explanation: "Incorrecto. 40 es el mcm de 8 y 10, pero no de 15." }, { text: "A la 1:00 p.m.", correct: false, explanation: "Incorrecto. Esto ser√≠a 60 minutos despu√©s. 60 es m√∫ltiplo de 10 y 15, pero no de 8." }, { text: "A las 2:00 p.m.", correct: true, explanation: "¬°Correcto! Se busca una coincidencia, por lo que se usa el mcm. El mcm(8, 10, 15) es 120 minutos, lo que equivale a 2 horas. Si sonaron a las 12:00 p.m., volver√°n a sonar a las 2:00 p.m." } ] },
            { question: "¬øCu√°l es el mcd de 1 y cualquier n√∫mero entero 'n'?", answers: [ { text: "n", correct: false, explanation: "Incorrecto. 'n' es divisor de 'n', pero no siempre es divisor de 1." }, { text: "1", correct: true, explanation: "¬°Correcto! El √∫nico divisor de 1 es 1. Como 1 divide a cualquier n√∫mero entero 'n', el m√°ximo com√∫n divisor es necesariamente 1." }, { text: "0", correct: false, explanation: "Incorrecto. El mcd no puede ser 0." } ] },
            { question: "Calcular el mcm de 2^3 * 3 y 2 * 3^2.", answers: [ { text: "2 * 3", correct: false, explanation: "Incorrecto. Esto es el mcd. Para el mcd se toman los factores comunes con el menor exponente." }, { text: "2^3 * 3^2", correct: true, explanation: "¬°Correcto! Para el mcm de n√∫meros descompuestos en factores primos, se toman todos los factores (comunes y no comunes) con su mayor exponente. En este caso, 2^3 y 3^2." }, { text: "2^4 * 3^3", correct: false, explanation: "Incorrecto. Se deben usar los exponentes presentes en los n√∫meros, no sumarlos." } ] },
            { question: "Un agricultor recoge 100 manzanas y 80 peras y quiere hacer cajas con el mismo contenido. ¬øCu√°l es el mayor n√∫mero de cajas que puede hacer?", answers: [ { text: "10", correct: false, explanation: "Incorrecto. 10 es un n√∫mero de cajas posible, pero no es el mayor. Se puede dividir en m√°s cajas." }, { text: "20", correct: true, explanation: "¬°Correcto! Se busca el mayor n√∫mero de cajas (grupos), lo que implica el mcd. El mcd(100, 80) es 20. Puede hacer 20 cajas." }, { text: "400", correct: false, explanation: "Incorrecto. Este es el mcm. No se puede hacer m√°s cajas que el n√∫mero de frutas." } ] }
        ];

        const motivationalTips = [
            "¬°Cada error es un paso m√°s cerca de la maestr√≠a!",
            "La pr√°ctica constante construye la confianza.",
            "¬°Sigue as√≠, lo est√°s haciendo genial!",
            "Analiza la pregunta, a veces la clave est√° en una sola palabra.",
            "Recuerda: MCD divide, MCM multiplica.",
            "¬°T√∫ puedes con esto y m√°s!",
            "La perseverancia es clave para el √©xito.",
            "Conf√≠a en tu proceso de aprendizaje."
        ];

        // Gamification variables
        const userProfile = {
            name: 'Estudiante',
            level: 1,
            xp: 0,
            xpForNextLevel: 100,
            achievements: []
        };

        const achievements = [
            { id: 'FIRST_QUIZ', name: 'Rompiendo el Hielo', desc: 'Completa tu primer cuestionario.', unlocked: false },
            { id: 'STREAK_3', name: '¬°En Racha!', desc: 'Responde 3 preguntas seguidas correctamente.', unlocked: false },
            { id: 'MCM_MASTER', name: 'Maestro de M√∫ltiplos', desc: 'Responde 5 preguntas de MCM correctamente.', unlocked: false },
            { id: 'MCD_EXPERT', name: 'Experto Divisor', desc: 'Responde 5 preguntas de MCD correctamente.', unlocked: false },
            { id: 'SPEEDSTER', name: 'Velocista', desc: 'Responde una pregunta en menos de 15 segundos.', unlocked: false }
        ];
        
        // (JavaScript logic from previous context, with gamification integrated)
        let quizQuestions = [];
        let timePerQuestion = 90;
        let questionCount = 10;
        let questionOrder = 'random';
        
        const startScreen = document.getElementById('start-screen');
        const quizScreen = document.getElementById('quiz-screen');
        const resultsScreen = document.getElementById('results-screen');
        const studyMaterialContainer = document.getElementById('study-material-container');
        const studyContent = document.getElementById('study-content');
        
        const startButton = document.getElementById('start-button');
        const restartButton = document.getElementById('restart-button');
        const nextButton = document.getElementById('next-button');
        const studyGuideBtn = document.getElementById('study-guide-btn');
        const viewProblemsBtn = document.getElementById('view-problems-btn');
        const viewSolutionsBtn = document.getElementById('view-solutions-btn');
        const viewReferencesBtn = document.getElementById('view-references-btn');
        const closeStudyBtn = document.getElementById('close-study-btn');
        
        const questionCountInput = document.getElementById('question-count');
        const timeLimitInput = document.getElementById('time-limit');
        const questionOrderInput = document.getElementById('question-order');

        const questionCounter = document.getElementById('question-counter');
        const scoreDisplay = document.getElementById('score');
        const questionText = document.getElementById('question-text');
        const answerButtons = document.querySelectorAll('.answer-btn');
        const feedbackText = document.getElementById('feedback-text');
        const finalScore = document.getElementById('final-score');
        const finalSummary = document.getElementById('final-summary');
        const timerBar = document.getElementById('timer-bar');
        const tipText = document.getElementById('tip-text');
        const xpGainText = document.getElementById('xp-gain-text');

        // Gamification UI
        const profileLevel = document.getElementById('profile-level');
        const profileName = document.getElementById('profile-name');
        const profileAchievements = document.getElementById('profile-achievements');
        const profileXpBar = document.getElementById('profile-xp-bar');
        const profileXpText = document.getElementById('profile-xp-text');
        const achievementNotification = document.getElementById('achievement-notification');
        const achievementTitle = document.getElementById('achievement-title');
        const achievementDesc = document.getElementById('achievement-desc');

        let timerInterval;
        let timeLeft;
        let currentQuestionIndex = 0;
        let score = 0;
        let correctStreak = 0;
        let mcmCorrect = 0;
        let mcdCorrect = 0;

        function updateProfileUI() {
            profileLevel.textContent = userProfile.level;
            profileName.textContent = userProfile.name;
            const unlockedCount = achievements.filter(a => a.unlocked).length;
            profileAchievements.textContent = `Logros: ${unlockedCount}/${achievements.length}`;
            const xpPercentage = (userProfile.xp / userProfile.xpForNextLevel) * 100;
            profileXpBar.style.width = `${xpPercentage}%`;
            profileXpText.textContent = `${userProfile.xp}/${userProfile.xpForNextLevel} XP`;
        }

        function addXP(amount) {
            userProfile.xp += amount;
            if (userProfile.xp >= userProfile.xpForNextLevel) {
                userProfile.level++;
                userProfile.xp -= userProfile.xpForNextLevel;
                userProfile.xpForNextLevel = Math.floor(userProfile.xpForNextLevel * 1.5);
                unlockAchievement('LEVEL_UP', `¬°Nuevo Nivel!`, `Alcanzaste el nivel ${userProfile.level}.`);
            }
            updateProfileUI();
        }

        function unlockAchievement(id, name, desc) {
            const achievement = achievements.find(a => a.id === id);
            if (achievement && !achievement.unlocked) {
                achievement.unlocked = true;
                showAchievementNotification(achievement.name, achievement.desc);
                updateProfileUI();
            } else if (!achievement) { // For custom one-time notifications like level up
                 showAchievementNotification(name, desc);
            }
        }
        
        function showAchievementNotification(name, desc) {
            achievementTitle.textContent = name;
            achievementDesc.textContent = desc;
            achievementNotification.classList.add('show');
            setTimeout(() => {
                achievementNotification.classList.remove('show');
            }, 4000);
        }

        function startGame() {
            questionCount = parseInt(questionCountInput.value, 10);
            timePerQuestion = parseInt(timeLimitInput.value, 10);
            questionOrder = questionOrderInput.value;
            
            if(isNaN(questionCount) || questionCount < 1 || questionCount > allQuestions.length) {
                questionCount = allQuestions.length;
                questionCountInput.value = questionCount;
            }
             if(isNaN(timePerQuestion) || timePerQuestion < 10) {
                timePerQuestion = 90;
                timeLimitInput.value = timePerQuestion;
            }

            if (questionOrder === 'random') {
                quizQuestions = allQuestions.sort(() => 0.5 - Math.random()).slice(0, questionCount);
            } else {
                quizQuestions = allQuestions.slice(0, questionCount);
            }

            startScreen.classList.add('hidden');
            studyMaterialContainer.classList.add('hidden');
            resultsScreen.classList.add('hidden');
            quizScreen.classList.remove('hidden');
            
            currentQuestionIndex = 0;
            score = 0;
            correctStreak = 0;
            mcmCorrect = 0;
            mcdCorrect = 0;
            scoreDisplay.textContent = `Puntos: ${score}`;
            showQuestion();
        }

        function showQuestion() {
            resetState();
            const question = quizQuestions[currentQuestionIndex];
            questionCounter.textContent = `${currentQuestionIndex + 1} de ${quizQuestions.length}`;
            questionText.textContent = question.question;
            tipText.textContent = motivationalTips[Math.floor(Math.random() * motivationalTips.length)];


            question.answers.forEach((answer, index) => {
                const button = answerButtons[index];
                button.textContent = answer.text;
                button.dataset.correct = answer.correct;
            });
            
            startTimer();
        }

        function resetState() {
            answerButtons.forEach(button => {
                button.classList.remove('correct-answer', 'wrong-answer', 'disabled-button');
            });
            nextButton.classList.add('hidden');
            feedbackText.textContent = '';
            tipText.textContent = '';
        }
        
        function startTimer() {
            timeLeft = timePerQuestion;
            timerBar.style.transition = 'none';
            timerBar.style.width = '100%';
            void timerBar.offsetWidth; 
            timerBar.style.transition = `width ${timePerQuestion}s linear`;
            timerBar.style.width = '0%';

            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                timeLeft--;
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    handleTimeOut();
                }
            }, 1000);
        }
        
        function handleTimeOut() {
            correctStreak = 0;
            const correctAnswer = quizQuestions[currentQuestionIndex].answers.find(a => a.correct);
            feedbackText.textContent = `¬°Tiempo! La respuesta era: ${correctAnswer.text}`;
            feedbackText.classList.add('text-red-500');
            showCorrectAnswer();
            disableButtons();
        }

        function selectAnswer(e) {
            clearInterval(timerInterval);
            timerBar.style.width = timerBar.style.width;

            const selectedButton = e.target;
            const isCorrect = selectedButton.dataset.correct === 'true';

            disableButtons();

            if (isCorrect) {
                addXP(10); // +10 XP for correct answer
                score += 100;
                correctStreak++;
                scoreDisplay.textContent = `Puntos: ${score}`;
                selectedButton.classList.add('correct-answer');
                feedbackText.textContent = '¬°Correcto!';
                feedbackText.classList.remove('text-red-500', 'text-yellow-400');
                feedbackText.classList.add('text-green-500');
                
                // Check achievements
                if (timeLeft >= (timePerQuestion - 15)) {
                    unlockAchievement('SPEEDSTER');
                }
                if (correctStreak >= 3) {
                     unlockAchievement('STREAK_3');
                }
                const qText = quizQuestions[currentQuestionIndex].question.toLowerCase();
                if (qText.includes('mcm') || qText.includes('m√∫ltiplo') || qText.includes('coincidir') || qText.includes('encontrar')) {
                    mcmCorrect++;
                    if (mcmCorrect >= 5) unlockAchievement('MCM_MASTER');
                }
                if (qText.includes('mcd') || qText.includes('divisor') || qText.includes('cortar') || qText.includes('dividir') || qText.includes('m√°s grande') || qText.includes('mayor')) {
                    mcdCorrect++;
                    if (mcdCorrect >= 5) unlockAchievement('MCD_EXPERT');
                }

            } else {
                correctStreak = 0;
                selectedButton.classList.add('wrong-answer');
                const correctAnswer = quizQuestions[currentQuestionIndex].answers.find(a => a.correct);
                const hint = correctAnswer.explanation.split('!')[1].split('.')[0] + ".";
                
                feedbackText.textContent = `Incorrecto. Pista: ${hint}`;
                feedbackText.classList.remove('text-green-500', 'text-red-500');
                feedbackText.classList.add('text-yellow-400');

                setTimeout(() => {
                    feedbackText.textContent = `La respuesta es: ${correctAnswer.text}.`;
                    feedbackText.classList.remove('text-yellow-400');
                    feedbackText.classList.add('text-red-500');
                    showCorrectAnswer();
                }, 3000);
            }
        }
        
        function disableButtons() {
             answerButtons.forEach(button => {
                if (button.dataset.correct !== 'true' && !button.classList.contains('wrong-answer')) {
                    button.classList.add('wrong-answer');
                }
                button.classList.add('disabled-button');
            });
            nextButton.classList.remove('hidden');
        }

        function showCorrectAnswer() {
            answerButtons.forEach(button => {
                if (button.dataset.correct === 'true') {
                    button.classList.add('correct-answer');
                }
            });
        }
        
        function showNextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex < quizQuestions.length) {
                showQuestion();
            } else {
                showResults();
            }
        }
        
        function showResults() {
            unlockAchievement('FIRST_QUIZ');
            const bonusXP = 50;
            addXP(bonusXP);

            quizScreen.classList.add('hidden');
            resultsScreen.classList.remove('hidden');
            finalScore.textContent = score;
            const correctCount = score / 100;
            finalSummary.textContent = `Obtuviste ${correctCount} de ${quizQuestions.length} correctas.`;
            xpGainText.textContent = `+${(correctCount * 10) + bonusXP} XP ¬°Bono por completar!`;
        }
        
        function showProblems() {
            let html = '<h2 class="text-3xl font-bold mb-4 text-center font-title">Banco de Problemas</h2>';
            allQuestions.forEach((q, index) => {
                html += `<div class="mb-4 p-2 border-b"><p class="font-bold">${index + 1}. ${q.question}</p></div>`;
            });
            studyContent.innerHTML = html;
            startScreen.classList.add('hidden');
            studyMaterialContainer.classList.remove('hidden');
        }

        function showSolutions() {
            let html = '<h2 class="text-3xl font-bold mb-6 text-center font-title">Solucionario Detallado</h2>';
            allQuestions.forEach((q, index) => {
                html += `<div class="mb-6 pb-4 border-b border-gray-300">
                            <p class="font-bold text-lg mb-3">${index + 1}. ${q.question}</p>
                            <ul>`;
                q.answers.forEach(ans => {
                    const bgColor = ans.correct ? 'bg-green-100 border-green-500' : 'bg-red-100 border-red-500';
                    const textColor = ans.correct ? 'text-green-800' : 'text-red-800';
                     html += `<li class="mb-2 p-3 rounded ${bgColor} border-l-4">
                                <strong class="${textColor}">${ans.text}</strong>
                                <p class="text-sm text-gray-700 mt-1">${ans.explanation}</p>
                              </li>`;
                });
                html += `</ul></div>`;
            });
            studyContent.innerHTML = html;
            startScreen.classList.add('hidden');
            studyMaterialContainer.classList.remove('hidden');
        }

        function showReferences() {
            let html = `
                <h2 class="text-3xl font-bold mb-6 text-center font-title">Referencias para Estudiar</h2>
                <div class="mb-8"><h3 class="text-2xl font-bold mb-3 text-purple-800 border-b-2 border-purple-200 pb-2 font-title">Videos de YouTube</h3><ul class="list-disc list-inside space-y-2">
                    <li><a href="https://youtu.be/2Pxsm91QiRU?si=jpnrRWFNTuftDtYE" target="_blank" class="text-blue-600 hover:underline">Diferencias entre el mcd y el mcm por Daniel Carre√≥n</a></li>
                    <li><a href="https://www.youtube.com/watch?v=W3g4QxlN4xQ&list=PLeySRPnY35dGfGMTx3uJ_v1Q9ccLbZYNp" target="_blank" class="text-blue-600 hover:underline">Lista de reproducci√≥n del tema por profe Alex</a></li>
                    <li><a href="https://youtu.be/FiopqzCb2LI?si=rr-nG_0AXL6jTcmI" target="_blank" class="text-blue-600 hover:underline">MCM por Math2me</a></li>
                </ul></div>
                <div class="mb-8"><h3 class="text-2xl font-bold mb-3 text-purple-800 border-b-2 border-purple-200 pb-2 font-title">Plataformas Educativas</h3><ul class="list-disc list-inside space-y-2">
                    <li><a href="https://es.khanacademy.org/math/pre-algebra/pre-algebra-factors-multiples/pre-algebra-greatest-common-divisor/v/greatest-common-divisor" target="_blank" class="text-blue-600 hover:underline">Khan Academy: M√°ximo Com√∫n Divisor (Lecci√≥n y videos)</a></li>
                    <li><a href="https://es.khanacademy.org/math/pre-algebra/pre-algebra-factors-multiples/pre-algebra-least-common-multiple/v/least-common-multiple-exercise" target="_blank" class="text-blue-600 hover:underline">Khan Academy: M√≠nimo Com√∫n M√∫ltiplo (Lecci√≥n y videos)</a></li>
                </ul></div>
                <div><h3 class="text-2xl font-bold mb-3 text-purple-800 border-b-2 border-purple-200 pb-2 font-title">Bibliograf√≠a</h3><ul class="list-disc list-inside space-y-2">
                    <li><strong>√Ålgebra de Baldor</strong> por Aurelio Baldor: Un cl√°sico fundamental para el √°lgebra preuniversitaria. Los cap√≠tulos sobre divisibilidad, mcd y mcm son muy completos y contienen numerosos ejercicios.</li>
                    <li><strong>Aritm√©tica Te√≥rico-Pr√°ctica</strong> por A. Baldor: Complemento del anterior, enfocado en los fundamentos num√©ricos. Explica los conceptos de m√∫ltiplos y divisores con gran detalle.</li>
                    <li><strong>Pre√°lgebra</strong> por OpenStax (disponible gratis en l√≠nea): Un recurso moderno y accesible que cubre todos los temas fundamentales, incluyendo factores y m√∫ltiplos, con un enfoque claro y pr√°ctico.</li>
                </ul></div>`;
            studyContent.innerHTML = html;
            startScreen.classList.add('hidden');
            studyMaterialContainer.classList.remove('hidden');
        }

        function showStudyGuide() {
            let html = `
                <h2 class="text-3xl font-bold mb-6 text-center font-title">Gu√≠a de Estudio: MCM y MCD</h2>
                
                <div class="bg-purple-50 p-6 rounded-lg mb-6">
                    <h3 class="text-2xl font-bold mb-3 text-purple-800 font-title">1. Conceptos Fundamentales</h3>
                    <p class="mb-4">Para dominar el MCM y el MCD, primero debemos entender dos ideas clave: los **n√∫meros primos** y la **descomposici√≥n factorial**.</p>
                    <p>Un <strong>N√∫mero Primo</strong> es aquel que solo puede dividirse entre 1 y s√≠ mismo (ej. 2, 3, 5, 7, 11...).</p>
                    <p>La <strong>Descomposici√≥n Factorial</strong> es expresar un n√∫mero como un producto de sus factores primos. Por ejemplo, el n√∫mero 12 se descompone as√≠:</p>
                    <p class="text-center font-mono bg-gray-200 p-2 rounded my-2">
                        12 | 2 <br>
                         6 | 2 <br>
                         3 | 3 <br>
                         1 |
                    </p>
                    <p>Esto significa que: \\( 12 = 2 \\times 2 \\times 3 = 2^2 \\times 3 \\)</p>
                </div>

                <div class="bg-blue-50 p-6 rounded-lg mb-6">
                    <h3 class="text-2xl font-bold mb-3 text-blue-800 font-title">2. M√°ximo Com√∫n Divisor (MCD)</h3>
                    <p class="mb-2">Es el <strong>n√∫mero m√°s grande</strong> que puede dividir a dos o m√°s n√∫meros sin dejar residuo.</p>
                    <p class="font-bold mb-2">M√©todo de c√°lculo:</p>
                    <ol class="list-decimal list-inside space-y-2">
                        <li>Descomp√≥n cada n√∫mero en sus factores primos.</li>
                        <li>Identifica los factores primos <strong>comunes</strong> a todas las descomposiciones.</li>
                        <li>Multiplica estos factores comunes, usando siempre el <strong>menor exponente</strong> con el que aparezcan.</li>
                    </ol>
                    <p class="mt-4"><strong>Ejemplo: MCD(36, 48)</strong></p>
                    <p>\\( 36 = 2^2 \\times 3^2 \\)</p>
                    <p>\\( 48 = 2^4 \\times 3^1 \\)</p>
                    <p>Factores comunes: 2 y 3. Menores exponentes: \\(2^2\\) y \\(3^1\\).</p>
                    <p class="font-bold text-lg">MCD = \\( 2^2 \\times 3^1 = 4 \\times 3 = 12 \\)</p>
                </div>
                
                <div class="bg-green-50 p-6 rounded-lg mb-6">
                    <h3 class="text-2xl font-bold mb-3 text-green-800 font-title">3. M√≠nimo Com√∫n M√∫ltiplo (MCM)</h3>
                    <p class="mb-2">Es el <strong>n√∫mero m√°s peque√±o</strong> que es m√∫ltiplo de dos o m√°s n√∫meros.</p>
                    <p class="font-bold mb-2">M√©todo de c√°lculo:</p>
                     <ol class="list-decimal list-inside space-y-2">
                        <li>Descomp√≥n cada n√∫mero en sus factores primos.</li>
                        <li>Selecciona <strong>todos</strong> los factores primos, tanto los comunes como los no comunes.</li>
                        <li>Multiplica estos factores, usando siempre el <strong>mayor exponente</strong> con el que aparezcan.</li>
                    </ol>
                    <p class="mt-4"><strong>Ejemplo: MCM(36, 48)</strong></p>
                    <p>\\( 36 = 2^2 \\times 3^2 \\)</p>
                    <p>\\( 48 = 2^4 \\times 3^1 \\)</p>
                    <p>Todos los factores: 2 y 3. Mayores exponentes: \\(2^4\\) y \\(3^2\\).</p>
                    <p class="font-bold text-lg">MCM = \\( 2^4 \\times 3^2 = 16 \\times 9 = 144 \\)</p>
                </div>
                
                <div class="bg-yellow-50 p-6 rounded-lg mb-6">
                    <h3 class="text-2xl font-bold mb-3 text-yellow-800 font-title">4. Estrategia para EXANI-II</h3>
                    <p class="mb-4">En el examen, la clave no es solo calcular, sino saber <strong>cu√°ndo usar cada uno</strong>. ¬°Identifica las palabras clave!</p>
                    <table class="w-full text-center border">
                        <thead><tr class="bg-gray-200"><th class="border p-2">Usa MCD si lees...</th><th class="border p-2">Usa MCM si lees...</th></tr></thead>
                        <tbody>
                            <tr><td class="border p-2">Dividir, repartir, cortar</td><td class="border p-2">Coincidir, encontrar, repetir</td></tr>
                            <tr><td class="border p-2">El mayor tama√±o posible</td><td class="border p-2">La pr√≥xima vez que...</td></tr>
                            <tr><td class="border p-2">M√°ximo, m√°s grande, m√°s amplio</td><td class="border p-2">M√≠nimo, m√°s peque√±o, la primera vez</td></tr>
                        </tbody>
                    </table>
                    <h4 class="font-bold mt-4">Tips Clave para el Examen:</h4>
                     <ul class="list-disc list-inside mt-2 space-y-1">
                        <li><strong>El MCD nunca es mayor</strong> que el n√∫mero m√°s peque√±o del grupo.</li>
                        <li><strong>El MCM nunca es menor</strong> que el n√∫mero m√°s grande del grupo.</li>
                        <li><strong>Preguntas de 2 pasos:</strong> A veces te piden el n√∫mero de trozos, no su tama√±o (MCD). O la hora exacta, no los minutos (MCM). ¬°Lee con atenci√≥n!</li>
                        <li><strong>Propiedad √∫til:</strong> Para dos n√∫meros A y B: \\( A \\times B = MCD(A,B) \\times MCM(A,B) \\).</li>
                    </ul>
                </div>
            `;
            studyContent.innerHTML = html;
            startScreen.classList.add('hidden');
            studyMaterialContainer.classList.remove('hidden');
            // Re-render MathJax content
            MathJax.typeset();
        }

        function closeStudyMaterial() {
            studyMaterialContainer.classList.add('hidden');
            startScreen.classList.remove('hidden');
        }

        // Initial setup
        updateProfileUI();
        
        // Event Listeners
        startButton.addEventListener('click', startGame);
        restartButton.addEventListener('click', () => {
             // Reset achievements for replayability in this demo
            achievements.forEach(a => a.unlocked = false);
            updateProfileUI();
            startGame();
        });
        nextButton.addEventListener('click', showNextQuestion);
        studyGuideBtn.addEventListener('click', showStudyGuide);
        viewProblemsBtn.addEventListener('click', showProblems);
        viewSolutionsBtn.addEventListener('click', showSolutions);
        viewReferencesBtn.addEventListener('click', showReferences);
        closeStudyBtn.addEventListener('click', closeStudyMaterial);

        answerButtons.forEach(button => {
            button.addEventListener('click', selectAnswer);
        });
    </script>
</body>
</html>

