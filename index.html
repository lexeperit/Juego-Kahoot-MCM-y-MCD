<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kahoot! Desafío MCM y MCD</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Montserrat', sans-serif;
            background-color: #46178F;
            color: white;
        }
        .kahoot-bg {
            background-color: #46178F;
        }
        .btn-red { background-color: #E21B3C; }
        .btn-blue { background-color: #1368CE; }
        .btn-green { background-color: #26890C; }
        .btn-yellow { background-color: #D89E00; }
        .btn-shape {
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.25rem;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
            transition: transform 0.1s ease-in-out;
        }
        .btn-shape:hover {
            transform: scale(1.05);
        }
        .correct-answer {
            animation: pulse-green 1s ease-in-out;
            box-shadow: 0 0 20px 5px rgba(46, 204, 113, 0.8);
        }
        .wrong-answer {
            opacity: 0.5;
        }
        .disabled-button {
            pointer-events: none;
        }
        @keyframes pulse-green {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        .timer-bar {
            transition: width 1s linear;
        }
    </style>
</head>
<body class="kahoot-bg min-h-screen flex items-center justify-center p-4">

    <div id="container" class="w-full max-w-4xl mx-auto text-center">

        <!-- Pantalla de Inicio -->
        <div id="start-screen">
            <h1 class="text-6xl md:text-8xl font-black tracking-tighter mb-4">Desafío</h1>
            <h2 class="text-4xl md:text-6xl font-bold mb-8">MCM y MCD</h2>
            <p class="text-xl mb-12">¿Estás listo para probar tus conocimientos al estilo EXANI-II?</p>
            <button id="start-button" class="bg-white text-gray-800 text-3xl font-bold py-4 px-12 rounded-lg shadow-2xl hover:bg-gray-200 transition-transform transform hover:scale-105">
                ¡Empezar!
            </button>
        </div>

        <!-- Pantalla del Quiz -->
        <div id="quiz-screen" class="hidden">
            <!-- Header del Quiz -->
            <div class="flex justify-between items-center bg-white text-gray-800 p-4 rounded-t-lg">
                <div id="question-counter" class="text-xl font-bold">1 de 10</div>
                <div class="text-2xl font-black">Desafío MCM y MCD</div>
                <div id="score" class="text-xl font-bold">Puntos: 0</div>
            </div>

            <!-- Pregunta y Timer -->
            <div class="bg-gray-800 p-8">
                <div id="timer-container" class="w-full bg-gray-600 rounded-full h-4 mb-6">
                    <div id="timer-bar" class="bg-yellow-400 h-4 rounded-full" style="width: 100%;"></div>
                </div>
                <h2 id="question-text" class="text-2xl md:text-3xl font-bold mb-8 min-h-[100px]">Cargando pregunta...</h2>
            </div>
            
            <!-- Opciones de Respuesta -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-gray-800 rounded-b-lg">
                <button data-option="0" class="answer-btn btn-shape btn-red rounded-lg h-32"></button>
                <button data-option="1" class="answer-btn btn-shape btn-blue rounded-lg h-32"></button>
                <button data-option="2" class="answer-btn btn-shape btn-green rounded-lg h-32"></button>
                <button id="next-button" class="btn-shape bg-gray-700 rounded-lg h-32 hidden">Siguiente</button>
            </div>
             <!-- Feedback -->
            <div id="feedback-text" class="mt-4 text-xl font-bold h-8"></div>
        </div>

        <!-- Pantalla de Resultados -->
        <div id="results-screen" class="hidden">
            <h1 class="text-5xl font-black mb-4">¡Juego Terminado!</h1>
            <div class="bg-white text-gray-800 rounded-lg p-8 text-center shadow-2xl">
                <h2 class="text-3xl font-bold mb-2">Tu Puntuación Final</h2>
                <p id="final-score" class="text-8xl font-black text-blue-600 mb-6">0</p>
                <p id="final-summary" class="text-2xl mb-8">Obtuviste 0 de 10 correctas.</p>
                <button id="restart-button" class="bg-green-500 text-white text-2xl font-bold py-3 px-10 rounded-lg hover:bg-green-600 transition-transform transform hover:scale-105">
                    Jugar de Nuevo
                </button>
            </div>
        </div>
    </div>

    <script>
        const questions = [
            {
                question: "Tres luces intermitentes se encienden a intervalos de 4, 6 y 10 segundos. Si coinciden a las 7:00 p.m., ¿después de cuántos segundos volverán a coincidir?",
                answers: [
                    { text: "60 segundos", correct: true },
                    { text: "2 segundos", correct: false },
                    { text: "120 segundos", correct: false }
                ],
                explanation: "Se busca un 'punto de encuentro' futuro, por lo que se usa el mcm. El mcm(4, 6, 10) es 60."
            },
            {
                question: "Un carpintero quiere cortar dos listones de madera de 90 cm y 120 cm en trozos de igual longitud, lo más largos posible. ¿Cuál debe ser la longitud de cada trozo?",
                answers: [
                    { text: "10 cm", correct: false },
                    { text: "360 cm", correct: false },
                    { text: "30 cm", correct: true }
                ],
                explanation: "Se busca 'dividir' en partes iguales y máximas, por lo que se usa el mcd. El mcd(90, 120) es 30."
            },
            {
                question: "Calcule el Máximo Común Divisor (mcd) de 24, 36 y 48.",
                answers: [
                    { text: "12", correct: true },
                    { text: "144", correct: false },
                    { text: "6", correct: false }
                ],
                explanation: "El número más grande que divide a los tres exactamente es 12."
            },
            {
                question: "Un paciente toma un jarabe cada 6 horas y una pastilla cada 8 horas. Si tomó ambos a las 9:00 a.m., ¿a qué hora volverá a tomar ambos medicamentos juntos?",
                answers: [
                    { text: "A las 9:00 a.m. del siguiente día", correct: true },
                    { text: "A la 1:00 p.m. del mismo día", correct: false },
                    { text: "A las 3:00 a.m. del día siguiente", correct: false }
                ],
                explanation: "El mcm(6, 8) es 24. Coincidirán 24 horas después, es decir, a las 9:00 a.m. del día siguiente, pero la opción correcta más cercana en el ciclo de 12h es 9 p.m. (error en la pregunta original, ajustado a 24h=9am día siguiente)." // Corregido el razonamiento, pero las opciones se mantienen para el ejercicio. La opción A es la única que tiene sentido en un ciclo de 12 horas si la coincidencia fuera a las 12h, pero siendo 24, el espíritu es buscar el mcm. Para este examen, la coincidencia de 24 horas después nos lleva a la misma hora del día siguiente. Si el examen busca la próxima coincidencia, la opción A (9pm) es la más lógica.
            },
             {
                question: "Calcule el Mínimo Común Múltiplo (mcm) de 15, 20 y 30.",
                answers: [
                    { text: "5", correct: false },
                    { text: "60", correct: true },
                    { text: "120", correct: false }
                ],
                explanation: "El número más pequeño que es múltiplo de los tres es 60."
            },
            {
                question: "Se tienen 54 chocolates y 72 caramelos. Se quieren armar bolsas con la misma cantidad de cada dulce, de modo que se use el mayor número de bolsas posible. ¿Cuántos chocolates habrá en cada bolsa?",
                answers: [
                    { text: "18", correct: false }, // Este es el mcd, número de bolsas
                    { text: "4", correct: false }, // Caramelos por bolsa
                    { text: "3", correct: true } // Chocolates por bolsa
                ],
                explanation: "El mcd(54, 72) es 18, que es el número de bolsas. Para saber los chocolates por bolsa, se divide 54 / 18 = 3."
            },
            {
                question: "Si el mcd de dos números es 6 y su mcm es 72, y uno de los números es 18, ¿cuál es el otro número?",
                answers: [
                    { text: "24", correct: true },
                    { text: "12", correct: false },
                    { text: "36", correct: false }
                ],
                explanation: "Se usa la propiedad: a × b = mcd(a,b) × mcm(a,b). Entonces, 18 × b = 6 × 72. b = 432 / 18 = 24."
            },
            {
                question: "Ana va a la biblioteca cada 4 días y Luis va cada 5 días. Si hoy se encontraron, ¿en cuántos días volverán a encontrarse?",
                answers: [
                    { text: "10 días", correct: false },
                    { text: "20 días", correct: true },
                    { text: "9 días", correct: false }
                ],
                explanation: "Buscamos el próximo encuentro, por lo tanto, es el mcm. El mcm(4, 5) = 20."
            },
            {
                question: "Calcule el mcd de 100 y 150.",
                answers: [
                    { text: "25", correct: false },
                    { text: "50", correct: true },
                    { text: "300", correct: false }
                ],
                explanation: "El divisor más grande que comparten 100 y 150 es 50."
            },
            {
                question: "¿Cuál es el mcm de dos números primos diferentes, como 7 y 13?",
                answers: [
                    { text: "1", correct: false },
                    { text: "Su suma (20)", correct: false },
                    { text: "Su producto (91)", correct: true }
                ],
                explanation: "El mcm de dos números primos es siempre el resultado de su multiplicación."
            }
        ];

        const startScreen = document.getElementById('start-screen');
        const quizScreen = document.getElementById('quiz-screen');
        const resultsScreen = document.getElementById('results-screen');
        
        const startButton = document.getElementById('start-button');
        const restartButton = document.getElementById('restart-button');
        const nextButton = document.getElementById('next-button');

        const questionCounter = document.getElementById('question-counter');
        const scoreDisplay = document.getElementById('score');
        const questionText = document.getElementById('question-text');
        const answerButtons = document.querySelectorAll('.answer-btn');
        const feedbackText = document.getElementById('feedback-text');

        const finalScore = document.getElementById('final-score');
        const finalSummary = document.getElementById('final-summary');
        
        const timerBar = document.getElementById('timer-bar');
        const timePerQuestion = 90; // 90 segundos
        let timerInterval;
        let timeLeft;

        let currentQuestionIndex = 0;
        let score = 0;

        function startGame() {
            startScreen.classList.add('hidden');
            resultsScreen.classList.add('hidden');
            quizScreen.classList.remove('hidden');
            currentQuestionIndex = 0;
            score = 0;
            scoreDisplay.textContent = `Puntos: ${score}`;
            showQuestion();
        }

        function showQuestion() {
            resetState();
            const question = questions[currentQuestionIndex];
            questionCounter.textContent = `${currentQuestionIndex + 1} de ${questions.length}`;
            questionText.textContent = question.question;

            question.answers.forEach((answer, index) => {
                const button = answerButtons[index];
                button.textContent = answer.text;
                button.dataset.correct = answer.correct;
            });
            
            startTimer();
        }

        function resetState() {
            answerButtons.forEach(button => {
                button.classList.remove('correct-answer', 'wrong-answer', 'disabled-button');
                button.classList.remove('hidden');
            });
            nextButton.classList.add('hidden');
            feedbackText.textContent = '';
        }
        
        function startTimer() {
            timeLeft = timePerQuestion;
            timerBar.style.transition = 'none';
            timerBar.style.width = '100%';
            // Forzar reflow para reiniciar la animación
            void timerBar.offsetWidth; 
            timerBar.style.transition = `width ${timePerQuestion}s linear`;
            timerBar.style.width = '0%';

            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                timeLeft--;
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    handleTimeOut();
                }
            }, 1000);
        }

        function handleTimeOut() {
            feedbackText.textContent = "¡Se acabó el tiempo! La respuesta correcta era:";
            feedbackText.classList.add('text-red-500');
            showCorrectAnswer();
            disableButtons();
        }

        function selectAnswer(e) {
            clearInterval(timerInterval);
            timerBar.style.width = timerBar.style.width; // Pausa la animación

            const selectedButton = e.target;
            const isCorrect = selectedButton.dataset.correct === 'true';

            disableButtons(); // Deshabilitar botones inmediatamente

            if (isCorrect) {
                score += 100;
                scoreDisplay.textContent = `Puntos: ${score}`;
                selectedButton.classList.add('correct-answer');
                feedbackText.textContent = '¡Correcto!';
                feedbackText.classList.remove('text-red-500', 'text-yellow-400');
                feedbackText.classList.add('text-green-500');
            } else {
                selectedButton.classList.add('wrong-answer');
                
                const fullExplanation = questions[currentQuestionIndex].explanation;
                // La primera oración como pista.
                const hint = fullExplanation.split('.')[0] + ".";
                
                feedbackText.textContent = `Incorrecto. Pista: ${hint}`;
                feedbackText.classList.remove('text-green-500', 'text-red-500');
                feedbackText.classList.add('text-yellow-400');

                setTimeout(() => {
                    feedbackText.textContent = "La respuesta es: " + fullExplanation;
                    feedbackText.classList.remove('text-yellow-400');
                    feedbackText.classList.add('text-red-500');
                    showCorrectAnswer();
                }, 3000); // 3 segundos de retraso
            }
        }

        function disableButtons() {
             answerButtons.forEach(button => {
                if (button.dataset.correct !== 'true' && !button.classList.contains('wrong-answer')) {
                    button.classList.add('wrong-answer');
                }
                button.classList.add('disabled-button');
            });
            nextButton.classList.remove('hidden');
            if(answerButtons.length > 2) answerButtons[2].classList.add('hidden'); // Ocultar el tercer botón para dar espacio a "Siguiente"
        }

        function showCorrectAnswer() {
            answerButtons.forEach(button => {
                if (button.dataset.correct === 'true') {
                    button.classList.add('correct-answer');
                }
            });
        }
        
        function showNextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex < questions.length) {
                showQuestion();
            } else {
                showResults();
            }
        }
        
        function showResults() {
            quizScreen.classList.add('hidden');
            resultsScreen.classList.remove('hidden');
            finalScore.textContent = score;
            const correctCount = score / 100;
            finalSummary.textContent = `Obtuviste ${correctCount} de ${questions.length} correctas.`;
        }

        startButton.addEventListener('click', startGame);
        restartButton.addEventListener('click', startGame);
        nextButton.addEventListener('click', showNextQuestion);
        answerButtons.forEach(button => {
            button.addEventListener('click', selectAnswer);
        });
    </script>
</body>
</html>

